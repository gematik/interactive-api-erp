{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "CommunicationDispReqPayload",
    "title": "Payload of CommunicationDispReq",
    "type": "object",
    "oneOf": [
        {
            "title": "Delivery & Shipment",
            "properties": {
                "version": { "$ref": "#/definitions/version" },
                "communicationType": {
                    "$ref": "#/definitions/communicationType",
                    "value": "order"
                },
                "supplyOptionsType": { "enum": ["delivery", "shipment"] },
                "firstname": {
                    "type": "string",
                    "maxLength": 45
                },
                "lastname": {
                    "type": "string",
                    "maxLength": 45
                },
                "address": {
                    "type": "string",
                    "minLength": 3,
                    "maxLength": 100
                },
                "postcode": {
                    "type": "string",
                    "minLength": 3,
                    "maxLength": 10
                },
                "city": {
                    "type": "string",
                    "minLength": 2,
                    "maxLength": 100
                },
                "country": {
                    "type": "string",
                    "minLength": 2,
                    "maxLength": 3,
                    "description": "2-letter country code as defined in ISO 3166-1."
                },
                "hint": { "$ref": "#/definitions/hint" },
                "text": { "$ref": "#/definitions/text" },
                "phone": { "$ref": "#/definitions/phone" },
                "mail": { "$ref": "#/definitions/mail" },
                "transactionID": { "$ref": "#/definitions/transactionID" }
            },
            "required": ["version", "communicationType", "firstname", "lastname", "address", "postcode", "city", "country", "phone"],
            "additionalProperties": false
        },
        {
            "title": "Reservation",
            "properties": {
                "version": { "$ref": "#/definitions/version" },
                "communicationType": {
                    "$ref": "#/definitions/communicationType",
                    "value": "order"
                },
                "supplyOptionsType": { "enum": ["reservation"] },
                "hint": { "$ref": "#/definitions/hint" },
                "text": { "$ref": "#/definitions/text" },
                "phone": { "$ref": "#/definitions/phone" },
                "mail": { "$ref": "#/definitions/mail" },
                "transactionID": { "$ref": "#/definitions/transactionID" }
            },
            "required": ["version", "communicationType", "phone"],
            "additionalProperties": false
        },
        {
            "title": "Message",
            "properties": {
                "version": { "$ref": "#/definitions/version" },
                "communicationType": {
                    "$ref": "#/definitions/communicationType",
                    "value": "text"
                },
                "hint": { "$ref": "#/definitions/hint" },
                "text": { "$ref": "#/definitions/text" },
                "phone": { "$ref": "#/definitions/phone" },
                "mail": { "$ref": "#/definitions/mail" },
                "transactionID": { "$ref": "#/definitions/transactionID" }
            },
            "required": ["version", "communicationType", "text", "transactionID"],
            "additionalProperties": false
        }
    ],
    "definitions": {
        "version": {
            "type": "number",
            "const": 3
        },
        "communicationType": {
            "enum": ["order", "text"],
            "description": "Communication type: 'order' to request a product with a chosen supply option (delivery, shipment, reservation). 'text' to send a free-form message related to the transaction."
        },
        "supplyOptionsType": {
            "enum": [
                "reservation",
                "shipment",
                "delivery"
            ]
        },
        "transactionID": {
            "type": "string",
            "maxLength": 50
        },
        "hint": {
            "type": "string",
            "maxLength": 100
        },
        "text": {
            "type": "string",
            "maxLength": 800
        },
        "phone": {
            "type": "string",
            "pattern": "^(\\+|00)[0-9]+$",
            "maxLength": 32,
            "description": "Telefonnummer E-164 Format, jedoch anstelle des „+“ mit „00“ / rein nummerisch."
        },
        "mail": {
            "type": "string",
            "pattern": "^.+@.{1,}\\..{1,}$"
        }
    },
    "required": [
        "version",
        "supplyOptionsType",
        "transactionID"
    ],
    "version": "2"
}